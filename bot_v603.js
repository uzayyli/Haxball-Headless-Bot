const room=HBInit({roomName:"ðŸ‘½ My Haxball Room",public:!0,maxPlayers:12,noPlayer:!0}),po=(room.setTeamsLock(!0),room.setScoreLimit(3),room.setTimeLimit(5),room.setDefaultStadium("Hockey"),room.startGame(),{}),pa=[],data={l:["admin1","admin2","admin3","admin4"],t:{url:"https://raw.githubusercontent.com/uzayyli/Haxball-Headless-Bot/main/example_maps.json",i:!0,data:{}},o:{u:[4,4],p:!1,v:!1,k:!1,$:!1},g:null,L:null,security:{bl_name:[],bl_namepart:[],bl_auth:[],bl_conn:[],M:!1,password:null,N:[],T:[],_:!1}},lib={say:(a,e)=>{room.sendAnnouncement(a,e,e?10151397:9633550)},A:(a,e=1)=>{var l=pa,r=room.sendAnnouncement;let t,i;for(t=l.length-1;0<=t;t--)(i=l[t]).B>=e&&r(a,i.id,16768768)},mute:(a,e,l=null,r=!0)=>{a.log.F=Date.now()+6e4*e,r&&lib.say(`ðŸ”• ${a.name} `+(0<e?e+" dakika susturuldu":"artÄ±k konuÅŸabilir")+(l?` (${l})`:""))},O:(a=null)=>{if(null===a||a.length<1)return null;if("#"===a[0])return po[parseInt(a.substring(1))];a=a.toLowerCase();let e,l,r,t=null;for(e=pa.length-1;0<=e;e--){if(l=pa[e],(r=l.name.toLowerCase())===a)return l;r.includes(a)&&(t=l)}return t},I:()=>{var i=data.o;if(!i.p){let a,e,l,r,t=Math;var o=[[],[],[]],n=[0,0],m=t.abs,u=t.floor,s=t.random;for(l=pa,t=l.length-1;0<=t;t--)a=l[t],0<=(e=a.team)&&e<3&&o[e].push(a);if(t=i.u,n[0]=t[0]-o[1].length,n[1]=t[1]-o[2].length,1<(r=m(t=n[0]-n[1])))for(l=t<0?(e=o[1],o[t=2]):(e=o[2],o[t=1]);1<r&&(a=e.splice(u(s()*e.length),1)[0]);)l.push(a),a.team=t,r-=2,n[t-1]--,n[2-t]++;for(t=0;t<2;t++)if(!(0<=(r=n[t]))){for(e=o[t+1],l=o[0];r<0;)r++,a=e.splice(u(s()*e.length),1)[0],l.push(a),a.team=0;n[t]=r}if((e=o[0]).length){for(t=e.length-1;0<t;t--)a=u(s()*(t+1)),[e[t],e[a]]=[e[a],e[t]];r=n[0]+n[1],(t=e.length)>r&&e.splice(r,t-r)}for(a=n[0],t=n[1],l=a===t?1+u(2*s()):a>t?1:2;e.length&&!(1===e.length&&i.$&&0<o[1].length+o[2].length&&n[0]===n[1]||0===n[l-1]&&0===n[(l=3-l)-1]);)a=e.pop(),o[l].push(a),n[(a.team=l)-1]--,l=3-l;for(t=room,r=t.setPlayerTeam,e=pa,n[0]=n[1]=0,t=e.length-1;0<=t;t--)a=e[t],0<=(l=a.team)&&l<3&&(r(a.id,l),0<l&&n[l-1]++);i.$&&1<n[0]+n[1]&&0!=(t=o[1].length-o[2].length)&&(e=o[0<t?1:2],(a=e.splice(u(s()*e.length),1)[0]).team=0,r(a.id,0))}},S:a=>{var e=room,l=(e.stopGame(),data.o),r=a.red>a.blue?1:2,a=`${1==r?"KÄ±rmÄ±zÄ±":"Mavi"} takÄ±m kazandÄ±. Tebrikler!`;if(l.p)return lib.say(a),setTimeout(e.startGame,1e3);var t=pa,i=e.setPlayerTeam,o=3-r;let n,m;if(l.v){m=po;var u=e.getPlayerList().map(a=>m[a.id]).filter(a=>0===a.team),s=[];for(n=t.length-1;0<=n;n--)(m=t[n]).team===o&&s.push(m);for(u.push(...s),n=s.length-1;0<=n;n--)(m=s[n]).team=0,i(m.id,0);for(m=l.u[o-1],u.splice(m,u.length-m),n=u.length-1;0<=n;n--)(m=u[n]).team=o,i(m.id,o)}else{var d=[],f=[];for(n=t.length-1;0<=n;n--){if((m=t[n]).team!==o){if(m.team!==r){if(0!==m.team)continue;f.push(m);continue}d.push(m)}m.team=0,i(m.id,0)}var b=[(m=l.u)[0],m[1]];for(n=Math.min(b[0]+b[1]-d.length,f.length);n;)d.push(f.pop()),n--;var c=(n=Math).floor,p=n.random;for(n=d.length-1;0<n;n--)m=c(p()*(n+1)),[d[n],d[m]]=[d[m],d[n]];for(n=1;d.length&&(m=d.pop(),!(b[n-1]<=0&&b[(n=3-n)-1]<=0));)m.team=n,i(m.id,n),n=3-n}lib.I(),lib.say(a),data.t.i&&lib.P.kits.f({name:"",B:4},["r"]),setTimeout(room.startGame,1e3)},P:{eval:{f:(p,a)=>{eval(a.join(" "))},type:"test",D:4,help:null,cd:5,hidden:!0},version:{f:a=>{lib.say("v6.0.3.h",a.id)},type:"public",D:0,help:null,cd:20},help:{f:(a,e)=>{var l=lib.P;let r;if(e.length){var t,i=e[0];if(i in l?r=l[i]:i in(t=lib.K)&&(r=l[t[i]]),!r)return lib.say("BÃ¶yle bir komut yok",a.id),!1;r.help&&r.D<=a.B&&lib.say(r.help,a.id)}else{var o=[],n=Object.keys(l);for(e=0;e<n.length;e++)(r=l[n[e]]).D<=a.B&&!r.hidden&&o.push(n[e]);o.length&&lib.say("komutlar: "+o.join(", "),a.id),lib.say("detaylÄ± bilgi iÃ§in: .help [komut]",a.id)}},type:"public",D:0,help:null,cd:10},say:{f:(a,e)=>{lib.say(a.name+": "+e.join(" "))},type:"chat",D:1,help:null,cd:5},admin:{f:(a,e)=>{var l=data.l,r=e[0],t=!!e[1];let i;for(i=0;i<l.length;i++)if(r===l[i])return a.B=i+1,room.setPlayerAdmin(a.id,!t),lib.A(a.name+` ${t?"-gizli- ":""}admin level `+(i+1),i+1);return lib.say("HatalÄ± ÅŸifre",a.id)},type:"system",D:0,help:"admin [password] or admin [password] hidden",cd:10},setadminlevel:{f:(a,e)=>{if(e.length<2)return-1;var l=lib.O(e[0]);if(!l)return-2;let r=parseFloat(e[1]),t=!!e[2];if(l.B<4&&4<=r&&(r=3),!(a.id===l.id&&4<=l.B)&&(r>a.B||r<l.B&&l.B>a.B))return lib.say("buna yetkiniz yok",a.id);l.B=r,room.setPlayerAdmin(l.id,0<r&&!t),lib.A(`${l.name} ${t?"-gizli- ":""}admin level ${r} (${a.name})`,r)},type:"system",D:2,help:"setadminlevel [player] [level=2] [hidden=false]",cd:20},mute:{f:(a,e)=>{if(e.length<2)return-1;var l=lib.O(e[0]);if(!l)return-2;let r=Math.min(parseFloat(e[1]),10);(isNaN(r)||r<0)&&(r=0),lib.mute(l,r,a.name,!0)},type:"chat",D:2,help:"mute [player] [minutes=1]",cd:3},muteall:{f:(a,e)=>{let l=Math.min(parseFloat(e[0]),10);(isNaN(l)||l<0)&&(l=0);var r=lib.mute;for(let a=pa.length-1;0<=a;a--)r(pa[a],l,null,!1);lib.say(`ðŸ”• herkes ${0<l?l+" dakika susturuldu":"konuÅŸabilir"} (${a.name})`)},type:"chat",D:2,help:"muteall [minutes=1]",cd:3},afk:{f:(a,e)=>{e=e.length&&1<a.B?lib.O(e[0]):a;if(!e)return-2;var l=3===e.team,r=l?0:3;room.setPlayerTeam(e.id,0),e.team=r,lib.I(),lib.say(e.name+` ${l?"oyuna geri dÃ¶ndÃ¼":"AFK"} `+(a.id===e.id?"":`(${a.name})`))},type:"public",D:0,help:"afk or afk [player]: toggles player's AFK status",cd:30},mix:{f:(a,e)=>{var l=pa,r=room.setPlayerTeam;Date.now();let t,i;for(t=l.length-1;0<=t;t--)1!==(i=l[t]).team&&2!==i.team||(i.team=0,r(i.id,0));lib.I(),lib.say(a.name+" takÄ±mlarÄ± kardÄ±")},type:"game",D:1,help:"mixes teams",cd:5},remix:{f:(a,e)=>{room.stopGame(),lib.P.mix.f(a),data.g=setTimeout(room.startGame,1e3)},type:"game",D:1,help:"mixes teams and restarts game",cd:20},restart:{f:(a,e)=>{room.stopGame(),data.g=setTimeout(room.startGame,1e3),lib.say(a.name+" oyunu baÅŸtan baÅŸlattÄ±")},type:"game",D:1,help:null,cd:10},gamemode:{f:(a,e)=>{var l=data.o;if(!e.length)return lib.say(`(${a.name}) oyun modu: ${l.u[0]}v${l.u[1]} ${l.v?"YS":"random"} ${l.k?"captain":"auto"} (${l.$?"eÅŸit takÄ±mlar":"herkes oyunda"})`,a.id);var r=e[0];if("m"===r[0])l.p=!0,lib.say(`(${a.name}) oyun modu: manual`);else{r=r.split("v");if(r.length<2)return-1;l.p=!1,l.u[0]=Math.max(0,r[0]),l.u[1]=Math.max(0,r[1]);var t=e[1];t&&t.length&&("y"===t[0]||"w"===t[0])?l.v=!0:l.v=!1,e[2]&&"c"===e[2][0]?lib.say("Captain mode is not implemented yet..",a.id):l.k=!1,e[3]&&"e"===e[3][0]?l.$=r[0]===r[1]:l.$=!1,lib.say(`(${a.name}) oyun modu: ${l.u[0]}v${l.u[1]} ${l.v?"YS":"random"} ${l.k?"captain":"auto"} (${l.$?"eÅŸit takÄ±mlar":"herkes oyunda"})`),lib.I()}},type:"game",D:2,help:".gm manual or .gm 4v4 [rand/(ys)] [(auto)/captain] [(freeForAll)/equalTeams]",cd:10},kick:{f:(a,e)=>{var l;return e.length?(l=lib.O(e[0]))?l.B>a.B?lib.say("Buna yetkiniz yok",a.id):void room.kickPlayer(l.id,""+a.name+(1<e.length?": "+e.slice(1,e.length).join(" "):""),!1):-2:-1},type:"security",D:2,help:"kick [player] [reason]",cd:5},ban:{f:(a,e)=>{var l;return e.length?(l=lib.O(e[0]))?l.B>a.B?lib.say("Buna yetkiniz yok",a.id):void room.kickPlayer(l.id,""+a.name+(1<e.length?": "+e.slice(1,e.length).join(" "):""),!0):-2:-1},type:"security",D:2,help:"kick [player] [reason]",cd:5},blacklist:{f:(a,e)=>{var l=e[0],r=data.security;if(-1===["name","namepart","auth","conn"].indexOf(l))return-1;let t=e[1];if(!t)return lib.say("bl_"+l+": "+JSON.stringify(r["bl_"+l]),a.id);"clear"===t?(r["bl_"+l]=[],lib.A(`cleared ${"bl_"+l} (${a.name})`,3)):("namepart"===l&&(t=t.toLocaleLowerCase()),r["bl_"+l].push(t),lib.A(`added '${t}' to ${"bl_"+l} (${a.name})`))},type:"security",D:3,help:"blacklist name/namepart/auth/conn [query]/clear",cd:5},security:{f:(a,e)=>{if(!e.length)return-1;var l,r=data.security,t=lib.A;let i,o;switch(e[0]){case"recentbans":i=r.T;break;case"captcha":return e.length<2?-1:(o=-1!==["on","1","true"].indexOf(e[1]),room.setRequireRecaptcha(o),t(`Captcha is ${o?"on":"off"} (${a.name})`,3));case"multilogin":return e.length<2?-1:a.B<4?lib.say("yoÄŸ",a.id):(o=-1!==["on","1","true"].indexOf(e[1]),t(`allowMultiLogin (from new tabs) is ${(r._=o)?"on":"off"} (${a.name})`,3));case"password":return e.length<2?-1:(l=e[1],l=-1!==["off","null","clear",""].indexOf(l)?null:"random"===l?Math.floor(1e11*Math.random()).toString(16):l,room.setPassword(l),t(a.name+" "+(l?"set room password: "+l:"cleared room password"),3));default:return-1}let n,m;1<e.length&&(n=e[1]),2<e.length&&(m=e[2]),o=n&&m?i.filter(a=>a[n]===m):i.slice(-(n||5)),lib.say(JSON.stringify(o),a.id)},type:"security",D:3,help:"security recentbans [key/maxNum] [value] or security captcha/password/multilogin [on/off/value]",cd:5},recentplayers:{f:(a,e)=>{var l=lib.say;let r=999;e.length&&(r=parseInt(e[0])),isNaN(r)&&(r=999);let t,i,o=data.security.N;for(o=o.slice(-r),t=o.length-1;0<=t;t--)l(`${(i=o[t]).name} | #${i.id} | @${i.conn} | `+i.auth,a.id)},type:"security",D:5,help:"recentplayers [maxNum]",cd:5,hidden:!0},clearban:{f:(a,e)=>{if(e.length<1)return-1;var l=data.security.T,r=room.clearBan;let t,i=0;if("all"===e[0])for(t=l.length-1;0<=t;t--)r(l[t].id),l.splice(t,1),i++;else{var o=e[0],n=e[1];if(-1===["id","name"].indexOf(o))return-1;for(t=l.length-1;0<=t;t--)l[t][o].toString()===n&&(r(l[t].id),l.splice(t,1),i++)}i&&lib.A(`${i} ban temizlendi (${a.name})`,3)},type:"security",D:3,help:"clearban [=all] or clearban [key] [value]",cd:10},maps:{f:(a,e)=>{const l=data.t;3<a.B&&e.length?"fetch"===e[0]&&(e[1]&&e[1].length&&(l.url=e[1]),fetch(l.url).then(function(a){return a.ok?a.json():Promise.reject({status:a.status,statusText:a.statusText})}).then(function(a){l.data=a}).catch(a=>{console.log("no custom stadiums: "+a)}),lib.A(a.name+" maplarÄ± fetchledi",4)):lib.say(Object.keys(l.data).join(", "),a.id)},type:"game",D:1,help:"maps (fetch [newUrl]): lists or fetches stadiums",cd:20},load:{f:(a,e)=>{if(!e.length)return-1;var l=data.t.data,r=e[0].toLowerCase(),t=Object.keys(l);let i,o,n=null;for(i=t.length-1;0<=i;i--){if((o=t[i].toLowerCase())===r){n=t[i];break}o.includes(r)&&(n=t[i])}if(!n)return lib.say("BÃ¶yle bir map yok",a.id);e=l[n];let m=e.hbs;"string"!=typeof m&&(m=e.hbs=JSON.stringify(m)),room.stopGame(),room.setCustomStadium(m),e.m&&e.m.length?data.L=e.m:data.L=null,lib.say(a.name+" loaded "+n),data.L&&lib.say(data.L),room.startGame()},type:"game",D:1,help:"load [stadiumName]",cd:20},motd:{f:(a,e)=>{var l,r=data;!!e.length?(l=e[0]).length&&"null"!==l&&"clear"!==l?(lib.A(a.name+" set welcome message",2),lib.say(r.L=e.join(" "))):(lib.A(a.name+" cleared welcome message",2),r.L=null):!r.L||r.L.length<1?lib.say("welcome message is null",a.id):lib.say(r.L)},type:"chat",D:2,help:"motd [message]: sets or prints auto welcome message",cd:5},avatar:{f:(a,e)=>{if(e.length<2)return-1;let l=e[0];if("all"===l)l=pa;else{var r=lib.O(l);if(!r)return-2;l=[r]}let t=e[1];"clear"===t?t=null:"default"===t&&(t="ðŸŽƒ");let i;for(i=l.length-1;0<=i;i--)room.setPlayerAvatar(l[i].id,t);1===l.length?lib.A(t?`${a.name} set ${l[0].name}'s avatar to `+t:`${a.name} cleared ${l[0].name}'s avatar`,2):lib.A(t?a.name+" set all avatars to "+t:a.name+" cleared all avatars",2)},type:"game",D:2,help:"avatar [player]/all default/clear/[avatar]",cd:10},kits:{f:(a,e)=>{if(e.length<1)return-1;let l=e[0];if("shuffle"===l)return e=!(1<e.length&&"off"===e[1]),data.t.i=e,lib.A(`Formalar her maÃ§ deÄŸiÅŸ${e?"ecek":"meyecek"} (${a.name})`,1);l="r"===l[0]?Math.floor(5*Math.random()):parseInt(l);var r=room.setTeamColors;switch(l){case 0:r(1,60,16777215,[16748922,9720903,5188902]),r(2,60,16777215,[8038911,4678292,2503759]);break;case 1:r(1,60,16777215,[16187581,11468994,7012531]),r(2,60,16777215,[3665292,3525836,3834818]);break;case 2:r(1,60,1118481,[15921906,13421772,10921638]),r(2,60,16777215,[5855577,3355443,855309]);break;case 3:r(1,60,16777215,[15376272,14709340,14042665]),r(2,60,16777215,[9482218,6064864,2713046]);break;case 4:r(1,60,16777215,[14447968,13715758,10434595]),r(2,60,16777215,[6327260,3041233,2313887]);break;default:return-1}a.name.length&&lib.A(a.name+" formalarÄ± deÄŸiÅŸtirdi",1)},type:"game",D:1,help:"kits [N]/rand/shuffle (on/off)",cd:10}},K:{"yardÄ±m":"help",komutlar:"help",gm:"gamemode",sec:"security"}};room.onPlayerJoin=a=>{const r=a.id,t=a.name,i=a.auth,o=a.conn;lib.A(`${a.name} #${r} | @${o} | `+i,5);let n;{var m,u=t.toLocaleLowerCase();let a=pa;for(n=a.length-1;0<=n;n--)if(a[n].name.toLocaleLowerCase()===u)return room.kickPlayer(r,"Odada aynÄ± adlÄ± bir oyuncu var.",!1);let e=!1,l=data.security;if(!l._)for(n=a.length-1;0<=n;n--)if((m=a[n].log).auth===i||m.conn===o)return room.kickPlayer(r,"Ã‡oklu giriÅŸ ("+a[n].name+")",!1);for(a=l.bl_name,n=a.length-1;0<=n;n--)if(a[n]===t){e=!0;break}if(!e)for(a=l.bl_namepart,n=a.length-1;0<=n;n--)if(u.includes(a[n])){e=!0;break}if(!e)for(a=l.bl_auth,n=a.length-1;0<=n;n--)if(a[n]===i){e=!0;break}if(!e)for(a=l.bl_conn,n=a.length-1;0<=n;n--)if(a[n]===o){e=!0;break}if(e)return room.kickPlayer(r,"blacklist",!0)}n=Date.now();var e,l={id:r,name:t,team:0,B:0,log:{auth:i,conn:o,F:-(n+1e4),H:0,j:0,q:n+5e3}};po[r]=l,pa.push(l);let s=null;{const d=data.security.N,n=d.findIndex(a=>a.conn===o||a.auth===i);-1!==n&&(e=d[n],s=e.name!==t?e.name:null,d.splice(n,1),0<e.F&&(l.log.F=e.F),e.q>l.log.q&&(l.log.q=e.q)),d.push({id:r,name:t,auth:i,conn:o,F:l.log.F,q:l.log.q}),30<d.length&&d.splice(0,1)}lib.say(`HoÅŸ geldin ${a.name}! `+(s?`(Ã–nceki ad: ${s})`:"")),lib.I(),(n=data.L)&&n.length&&lib.say(n,r),lib.say("âš ï¸ LÃ¼tfen AFK giderken .afk komutunu kullanmayÄ± unutmayalÄ±m, teÅŸekkÃ¼rler ðŸ™‚",r)},room.onPlayerLeave=l=>{const r=l.id,t=po[r];if(t){let a,e=pa;for(delete po[l.id],a=e.length-1;0<=a;a--)if(e[a].id===r){e.splice(a,1);break}e=data.security.N,-1!==(a=e.findIndex(a=>a.id===r))?(l=t.log,Object.assign(e[a],{F:l.F,q:l.q})):(e.push({id:r,name:t.name,auth:t.log.auth,conn:t.log.conn,F:t.log.F,q:t.log.q}),30<e.length&&e.splice(0,1)),lib.I()}},room.onPlayerTeamChange=(a,e)=>{var l;if(e)return 3===(l=po[a.id]).team&&0<a.team?(room.setPlayerTeam(a.id,0),lib.say(a.name+" AFK!",e.id)):void(l.team=a.team)},room.onPlayerAdminChange=(a,e)=>{if(e){var l=po[a.id],r=po[e.id];if(!a.admin&&l.B>r.B)return lib.A(e.name+" is not authorized to demote "+a.name,r.B),room.setPlayerAdmin(a.id,!0);l.B=a.admin?Math.max(1,l.B):0,lib.A(`${a.name} ${l.B<1?"adminliÄŸi alÄ±ndÄ±":"admin level "+l.B} (${e.name})`,r.B)}},room.onGameStart=()=>{clearTimeout(data.g)},room.onGameStop=a=>{a&&clearTimeout(data.g)},room.onTeamVictory=a=>{data.g=setTimeout(()=>{lib.S(a)},3e3)},room.onPlayerKicked=(e,a,l,r)=>{r=r||{id:0,name:"bot"},l&&((t=data.security.T).push({id:e.id,name:e.name,reason:a,J:r.id,Y:r.name}),30<t.length&&t.splice(0,1));var t,a=po[r.id];a&&a.B<2&&(l&&(room.clearBan(e.id),data.security.T=data.security.T.filter(a=>a.id!==e.id),lib.say(e.name+" ban kaldÄ±rÄ±ldÄ±")),room.kickPlayer(a.id,"Oyuncu kickleme yetkiniz yok",!1))},room.onStadiumChange=(a,e)=>{e&&(data.L=null)},room.onPlayerChat=(l,r)=>{var t=(l=po[l.id]).log,i=Date.now();if(l.B<1){let a,e=t.F;if(e<0&&(-e<i?t.F=0:15<r.length&&(e=t.F=-e)),e>i)return lib.say(Math.ceil((e-i)/1e3)+" saniye sonra yazÄ± yazabilirsiniz.",l.id),!1;if(5e3<(a=i-t.H))t.j=0;else if(a<1100&&1<++t.j)return t.j=0,lib.mute(l,1,"spam"),!1;t.H=i}var a=r[0];if(("!"===a||"."===a)&&(a=r[1],2<r.length&&"."!==a))try{lib.A(l.name+": "+r,5);var e,o=r.substring(1).split(" "),n=o[0].toLowerCase();let a=lib.P[n];if(!a){if(!(a=lib.K[n]))return lib.say("BÃ¶yle bir komut yok",l.id),!1;a=lib.P[a]}if(l.B<1){if(t.q>=i)return lib.say("LÃ¼tfen komutlarÄ± tekrar kullanmak iÃ§in biraz bekleyin",l.id),!1;t.q=i+1e3*(a.cd||5)}return a.D>l.B?lib.say("Bu komutu kullanmak iÃ§in yetkiniz yok",l.id):(e=a.f(l,o.slice(1)))&&(-1===e?(lib.say("YanlÄ±ÅŸ argÃ¼man sayÄ±sÄ±. DoÄŸru kullanÄ±m:",l.id),a.help&&lib.say(a.help,l.id)):-2===e&&lib.say("BÃ¶yle bir oyuncu yok. LÃ¼tfen oyuncu adÄ±nÄ±n bir kÄ±smÄ±nÄ± ya da ID'sini #123 ÅŸeklinde girin",l.id)),!1}catch(a){return lib.A(l.name+", bir sorun oldu: "+r,l.B),lib.A(a.message+" @"+a.lineNumber,l.B),!1}},lib.P.maps.f({name:"bot",B:4},["fetch"]),lib.P.kits.f({name:"",B:4},[0]);