(()=>{const room=HBInit({roomName:"👽 Haxball Room",public:!0,maxPlayers:12,noPlayer:!0}),_modules=(room.setDefaultStadium("Hockey"),room.startGame(),room.setTeamsLock(!0),room.setScoreLimit(3),room.setTimeLimit(5),{l:{t:"⚙️ Temel komutlar",i:["7","0","1","c"],o:{u:"",m:[]},p:(e,a)=>!!a||(util._(e,"Bu modülü kapatamazsınız"),!1),h:{k:null,v:null},g:{help:{f:(e,a)=>{var l,t,r,i=util;if(a)i.$(e,a);else{const n=e.M,s=Object.entries,o=room.sendAnnouncement;for([t,r]of s(_modules))(l=s(r.g).filter(e=>e[1].B<=n&&!e[1].hidden)).length&&(o(r.t+":",e.id,16768768),o(l.map(e=>e[0]).join(", "),e.id,9633550));i.D(e,"Detaylı bilgi için: .help [cmd], .help_params [cmd] ya da https://github.com/uzayyli/Haxball-Headless-Bot/wiki/Chat-Commands")}},B:0,cd:10,A:!1,N:{O:0,T:[{j:"string"}]},C:[".help",".help [cmd]"],F:["yardım","komutlar"]},help_params:{f:(t,r)=>{var i=util,n=i.D;if(r){var s=aliasDB.K[r]||aliasDB.P[r];util.D;if(!s)return i._(t,"Komut bulunamadı: "+r);if(s.B>t.M)return i._(t,{j:"noAllow"});var i=s.N,o=(n(t,`.${r} komutu için en az ${i.O} parametre gerekli`),i.T);let e,a,l;for(e=0;e<o.length;e++)a=o[e],l=`P${e+1}: [${a.j}]`,a.S&&(l+=` (one of: ${a.S.join(", ")})`),a.R&&(l+=" min: "+a.R),a.q&&(l+=" max: "+a.q),n(t,l)}else n(t,"Help for command parameter types:"),n(t,"[player]: supply part of player name, #id or @name"),n(t,"[players]: supply a single [player] or 'all', 'red', 'blue', 'afk', 'spec'"),n(t,"[boolean]: supply a truthy / falsy value such as '1' / '0', 'on' / 'off', 'y' / 'n' or 'true' / 'false'"),n(t,"[object]: expects a JSON.parse'able object (don't use spaces, curly braces can be omitted), e.g. {key1:value1,key2:value2}"),n(t,"use .help_params [cmd] for help on specific command")},B:1,cd:10,A:!1,N:{O:0,T:[{j:"string"}]},C:[".help_params",".help_params [cmd]"]},debug:{f:(e,a,...l)=>{let t;const r=util.D;switch(a){case"players":t=playerDB.G;break;case"playerphys":if(!(t=playerDB.G.filter(e=>1===e.team||2===e.team)).length)return r(e,"No players in game");t=[room.getPlayerDiscProperties(t[0].id)];break;default:return util._(e,"Unknown debug function")}l.length||(l=Object.keys(t[0]));let i;t.forEach(a=>{i=Object.fromEntries(l.map(e=>[e,a[e]])),r(e,JSON.stringify(i))})},B:4,cd:3,A:!1,N:{O:1,T:[{j:"string"}]},C:[".debug players / playerphys [keys]"]},eval:{f:(p,...args)=>{eval(args.join(" "))},B:4,cd:5,A:!0,N:{O:1,T:[]},C:[]},togglemodule:{f:(e,a,l)=>{var t=aliasDB.H[a];if(!t)return util._(e,"Available module names: "+Object.keys(aliasDB.H).join(", "));t.p(e,l),util.U(e.name+` set module '${a}' `+(l?"on":"off"),4)},B:4,cd:3,A:!1,N:{O:2,T:[{j:"string"},{j:"boolean"}]},C:[".togglemodule [module_name] [on_off]"]},version:{f:e=>{util.D(e,"v"+_modules.l.i.join("."))},B:0,cd:5,A:!1,N:{O:0,T:[]},C:null},say:{f:(e,...a)=>{util.say(e.name+": "+a.join(" "))},B:2,cd:3,A:!1,N:{O:1,T:[]},C:[".say [msg]: sends message in color"]},bb:{f:e=>{room.kickPlayer(e.id,"Yine bekleriz!",!1)},B:0,cd:3,A:!1,N:{O:0,T:[]},C:null},pm:{f:(a,e,...l)=>{const t=util.D,r=l.join(" ");e.m.forEach(e=>{t(e,r,a)})},B:5,cd:3,A:!1,N:{O:2,T:[{j:"players"}]},C:null},fetch:{f:(a,l,e)=>{let t;"maps"===l?t=_modules.l.o:"admins"===l&&(t=_modules.J.I),e?(t.u=e,util.U(a.name+` changed ${l} URL: `+e,4)):e=t.u,fetch(e).then(function(e){return e.ok?e.json():Promise.reject({status:e.status,statusText:e.statusText})}).then(function(e){t.m=e,util.U(a.name+" refetched "+l,4)}).catch(e=>{console.log(l+" fetch error: "+e)})},B:4,cd:3,A:!1,N:{O:1,T:[{j:"string",S:["maps","admins"]},{j:"string"}]},C:[".fetch (maps / admins) [URL]: second argument CHANGES the URL, no need to supply if you only want to re-fetch"]},maps:{f:e=>{util.D(e,_modules.l.o.m.map(e=>e.name).join(", "))},B:1,cd:3,A:!1,N:{O:0,T:[]},C:[".maps: shows the list of stadiums"]},load:{f:(a,e)=>{e=e.toLocaleLowerCase();var l=_modules.l.o.m;let t;for(t=l.length-1;0<=t;t--)if(l[t].name.toLocaleLowerCase().includes(e)){var r=l[t];let e=r.hbs;return"string"!=typeof e&&(r.hbs=e=JSON.stringify(e)),room.stopGame(),room.setCustomStadium(e),util.say(a.name+" loaded "+l[t].name),void room.startGame()}return util._(a,"Stadium not found")},B:1,cd:5,A:!1,N:{O:0,T:[]},C:[".load [mapName]: loads the stadium"]},restart:{f:e=>{room.stopGame(),room.startGame(),util.say(e.name+" oyunu yeniden başlattı")},B:1,cd:3,A:!1,N:{O:0,T:[]},C:[".restart: restarts the game"],F:["res"]},set:{f:(e,a,l,t,r)=>{var i=()=>!!room.getScores(),n="Bu komutu oyun devam ederken kullanamazsınız";switch(a){case"scorelimit":if(i())return util._(e,n);l=Math.floor(util.Y(l,0,14)),room.setScoreLimit(l);break;case"timelimit":if(i())return util._(e,n);l=Math.floor(util.Y(l,0,14)),room.setTimeLimit(l);break;case"teamslock":l=util.V(l),room.setTeamsLock(l);break;case"kickratelimit":if(l=util.Y(l),isNaN(l))return util._(e,"invalid value(s)");t=util.Y(t),isNaN(t)&&(t=0),r=util.Y(r),isNaN(r)&&(r=0),room.setKickRateLimit(l,t,r),l=`min: ${l} frames, rate: ${t}, burst: ${r} kicks`}util.U(e.name+` set ${a} = `+l,1)},B:1,cd:3,A:!1,N:{O:1,T:[{j:"string",S:["scorelimit","timelimit","teamslock","kickratelimit"]}]},C:[".set scorelimit [goals]",".set timelimit [minutes]",".set teamslock [boolean]",".set kickratelimit [min] [rate] [burst]"]},stop:{f:e=>{util.say(e.name+" oyunu durdurdu"),util.W(10)},B:2,cd:3,A:!1,N:{O:0,T:[]},C:[".stop: stops the game"]},start:{f:e=>{room.startGame(),util.say(e.name+" oyunu başlattı")},B:2,cd:3,A:!1,N:{O:0,T:[]},C:[".start: starts the game"]},pause:{f:e=>{room.pauseGame(!0),util.say(e.name+" oyunu duraklattı")},B:2,cd:3,A:!1,N:{O:0,T:[]},C:[".pause: pauses the game"]},unpause:{f:e=>{room.pauseGame(!1),util.say(e.name+" oyunu devam ettirdi")},B:2,cd:3,A:!1,N:{O:0,T:[]},C:[".unpause: resumes the game"],F:["resume"]},avatar:{f:(e,a,l)=>{const t=room.setPlayerAvatar;let r=l;if(2<l.length)switch(l){case"clear":case"null":r=null;break;case"poo":r="💩";break;case"alien":r="👽"}a.m.forEach(e=>{t(e.id,null===r?r:""+r)}),null===r?util.U(`${e.name} cleared [${a.X}] avatars`,2):util.U(`${e.name} set [${a.X}] avatars to `+r,2)},B:2,cd:3,A:!1,N:{O:2,T:[{j:"players"},{j:"string"}]},C:[".avatar [players] [avatarText]: avatarText = 'clear' to remove avatar"]}}},J:{t:"🔐 Güvenlik",Z:!1,I:{u:"",m:[]},ee:[],ae:[],le:!1,password:null,te:!0,bl_rules:[],p:(e,a)=>(a||util.D(e,"Güvenlik modülünü kapatmanız önerilmez"),!0),g:{mute:{f:(e,a,l)=>{const t=Date.now(),r=util.re;a.m.forEach(e=>{r(e,t,l,null,!1)}),util.say(`🔕 ${a.X} ${0<l?l+" dakika susturuldu":"konuşabilir"} (${e.name})`)},B:3,cd:3,A:!1,N:{O:2,T:[{j:"players",ie:!0},{j:"number",R:0,q:60}]},C:[".mute [players] [minutes]: set minutes = 0 to unmute"]},kick:{f:(e,a,...l)=>{if(a.M>e.M||a.id===e.id)return util._(e,{j:"noAllow"});l=l.join(" ");room.kickPlayer(a.id,l?e.name+": "+l:""+e.name,!1)},B:2,cd:3,A:!1,N:{O:1,T:[{j:"player"},{j:"string"}]},C:[".kick [player] [reason]"]},ban:{f:(e,a,...l)=>{if(a.M>e.M||a.id===e.id)return util._(e,{j:"noAllow"});l=l.join(" ");room.kickPlayer(a.id,l?e.name+": "+l:""+e.name,!0)},B:2,cd:3,A:!1,N:{O:1,T:[{j:"player"},{j:"string"}]},C:[".ban [player] [reason]"]},security:{f:(e,a,l)=>{switch(a){case"password":!l.length||["null","0","off","clear"].includes(l)?l=null:["rand","random"].includes(l)&&(l=Math.ceil(1e11*Math.random()).toString(16)),room.setPassword(l),util.U(l?e.name+" set room password: "+l:e.name+" cleared room password",3);break;case"captcha":l=util.V(l),room.setRequireRecaptcha(l),util.U(e.name+" set captcha "+(l?"on":"off"),3);break;case"blockmulti":l=util.V(l),_modules.J.te=l,util.U(e.name+" set blockMultiLogin (from new tabs) "+(l?"on":"off"),3)}},B:3,cd:3,A:!1,N:{O:1,T:[{j:"string",S:["password","captcha","blockmulti"]}]},C:[".sec password [value]: sets room password, set value to 'clear' to remove password",".sec captcha [on/off]",".sec blockmulti [on/off]: on by default. blocks new tab logins"],F:["sec"]},bans:{f:(a,e,l,t)=>{const r=_modules.J.ae,i=util.D;"list"===e?(i(a,"Ban listesi:"),r.forEach(e=>{i(a,`#${e.id} ${e.name} (reason: ${e.reason})`)})):"clear"===e&&(_modules.J.ae="name"===l?r.filter(e=>!e[l].includes(t)):r.filter(e=>e[l]!==t),util.U(`${a.name}, '${l}' = '${t}' eşleşen ban(lar) kaldırıldı, şu anda listede ${_modules.J.ae.length} ban var`,2))},B:2,cd:3,A:!1,N:{O:1,T:[{j:"string",S:["list","clear"]},{j:"string",S:["id","name"]}]},C:[".bans list: shows recent bans",".bans clear id 123: clears a ban with specific ID",".bans clear name [query]: clears ban(s) with names matching query",".bans clear all: clears all bans"]},recentplayers:{f:(a,l)=>{l=l&&l.toLocaleLowerCase();let e=_modules.J.ee,t=util.D;l&&l.length&&(e=e.filter(e=>e.name.toLocaleLowerCase().includes(l))),t(a,e.length+" recent player entries found:"),e.forEach(e=>{t(a,`(#${e.id}) ${e.name} | ${e.auth} `+(a.M<4?"":" | "+e.conn))})},B:3,cd:3,A:!1,N:{O:0,T:[]},C:[".recentplayers: shows all recent players",".recentplayers [query]: filters recent players based on name search"]},setadminlevel:{f:(e,a,l,t)=>{if(3<l&&e.id!==a.id)return util._(e,"Level 4 admin yetkisi bu komutla verilemez. Eğer bu kişiye %100 güveniyorsanız level 4 şifresini paylaşın ya da trustedAdmins.json dosyasına auth'unu kaydedin");e.id===a.id&&(3<e.M||l<=e.M)||e.M>a.M&&e.M>=l?util.ne(a,l,t,e):util._(e,{j:"noAllow"})},B:1,cd:3,A:!1,N:{O:2,T:[{j:"player"},{j:"number"},{j:"boolean"}]},C:[".sal [player] [level] [visible]: if you set last argument, player will be vanilla admin and can use mouse etc"],F:["sal"]},admin:{f:(e,a,l)=>{var t=_modules.J.se;let r,i=!1;for(r=0;r<t.length;r++)if(t[r].includes(a)){i=!0,r++;break}i&&util.ne(e,r,l,{name:"password"})},B:0,cd:10,A:!1,N:{O:1,T:[{j:"string"},{j:"boolean"}]},C:[".admin [password] [visible]: if you set last argument, you will be vanilla admin and can use mouse etc"]},trustedadmin:{f:(a,e,l,t)=>{const r=_modules.J.I,i=r.m,n=util.D;if("list"===e)n(a,i.length+" trusted admins, read from URL: "+r.u),i.forEach(e=>{n(a,`${e.d} (L${e.L}): ${e.a.substring(0,10)}...`)});else if("save"===e){if(!(l=util.oe(l))||!t)return util.$(a,"trustedadmin");const o=l.auth;var s=i.find(e=>e.a===o);if(s)return util._(a,"Bu auth zaten kayıtlı. Silmek için: .trustedadmin remove "+s.d);i.push({L:t,d:l.name+"_TEMP",a:o});s=`${l.name} (L${t}) admin listesine kaydedildi (${a.name})`;util.U(s,4),n(l,s)}else if("remove"===e){t=i.findIndex(e=>e.d.includes(l)||e.a===l);if(-1===t)return util._(a,"Bu kayıt bulunamadı. Listeyi görmek için: .trustedadmin list");util.U(i[t].d+" auth: "+i[t].a,4),util.U(`${i[t].d} admin listesinden silindi (${a.name})`,4),i.splice(t,1)}},B:4,cd:10,A:!1,N:{O:1,T:[{j:"string",S:["list","save","remove"]},{j:"string"},{j:"number",R:1,q:4}]},C:[".trustedadmin list: shows the list of saved admins",".trustedadmin save [player] [level]: TEMPORARILY saves player in trusted admins list. Change your .json file to permanently save",".trustedadmin remove [player/auth]: TEMPORARILY removes player from admin list"]},blacklist:{f:(a,l,t,r)=>{const i=_modules.J.bl_rules,n=util.D;switch(l){case"show":let e=i;t&&(e=e.filter(e=>e.j===t)),n(a,`Blacklist rules${t?" of type "+t:""}: (Total: ${e.length})`),e.forEach(e=>{n(a,e._rtype+" = "+e._rdata)});break;case"add":if("all"===t)return util._(a,"Invalid rule type");if(i.find(e=>e._rtype===t&&e._rdata===r))return util._(a,"This rule already exists");i.push({_rtype:t,_rdata:r}),util.U(`Blacklist rule #${i.length} added: ${t} = '${r}' (${a.name})`,3);break;case"clear":"all"===t?(i.splice(0,i.length),util.U(`All blacklist rules cleared (${a.name})`,3)):r?(_modules.J.bl_rules=i.filter(e=>e._rtype!==t&&e._rdata!==r),util.U(`Blacklist rule (${t} = '${r}') rule cleared (${a.name})`,3)):(_modules.J.bl_rules=i.filter(e=>e._rtype!==t),util.U(`All blacklist '${t}' rules cleared (${a.name})`,3))}},B:3,cd:3,A:!1,N:{O:1,T:[{j:"string",S:["show","add","clear"]},{j:"string"},{j:"string",S:["exactname","namepart","auth","conn","all"]},{j:"string"}]},C:[".blacklist show: shows the blacklist rules",".blacklist add [type] [data]: adds a new blacklist rule",".blacklist clear [type] [data]: removes a certain rule",".blacklist clear all: removes all rules","[type] can be one of 'exactname', 'namepart', 'auth', 'conn'"],F:["bl"]},playerinfo:{f:(l,e,a)=>{const t=util.D,r=JSON.stringify;let i=a?a.split(","):["auth","team"];(i=l.M<4&&i.includes("conn")?i.filter(e=>"conn"!==e):i).includes("all")&&4<=l.M?e.m.filter(e=>e.M<=l.M).forEach(e=>{t(l,`#${e.id} ${e.name}: `+r(e))}):e.m.filter(e=>e.M<=l.M).forEach(a=>{t(l,`#${a.id} ${a.name}: `+r(Object.fromEntries(i.map(e=>[e,a[e]]))))})},B:3,cd:3,A:!1,N:{O:1,T:[{j:"players"},{j:"string"}]},C:[".playerinfo [players] [keys]: shows player auth key and other info"]}}},ue:{t:"⚖️ Takımlar",me:[4,4],Z:!1,de:!1,ce:!1,pe:!1,_e:5,fe:[0,0],ye:{he:null,team:0},p:(e,a)=>(a&&_modules.ue.ke(e),!0),ke:e=>{var a=_modules.ue;a.de?a.be=()=>{}:(a.ce&&util._(e,"Forced equal teams not implemented yet!"),a.be=a.ve)},be:null,ge:()=>{},ve:()=>{const e=_modules.ue,[l,t]=e.me,r=Math,a=r.abs,i=[[],[],[]];playerDB.G.forEach(e=>{var a=e.team;a<3&&i[a].push(e)});var n,s=i.map(e=>e.length),o=[l-s[1],t-s[2]];totalNeed=o[0]+o[1];let u=i[0];1<u.length&&util.$e(u),u=u.slice(0,totalNeed);let m,d,c=o[0]-o[1],p=0<c?1:2;for(c=a(c),m=u.length-1;0<=m;m--)d=u[m],0===m&&0===c&&(n=(n=room.getScores()).red-n.blue,p=0<n?2:n<0?1:1+Math.floor(2*Math.random())),room.setPlayerTeam(d.id,d.team=p),s[p]++,i[p].push(d),--c<1&&(p=3-p);if(o[0]=l-s[1],o[1]=t-s[2],c=o[0]-o[1],1<(m=a(c))){var _=0<c?2:1,f=i[_],y=i[3-_];let e=r.floor(m/2),a;for(util.$e(f);e--;)a=f.pop(),s[_]--,room.setPlayerTeam(a.id,a.team=3-_),y.push(a),s[3-_]++;o[0]=l-s[1],o[1]=t-s[2]}for(m=1;m<3;m++){let e=-o[m-1];if(!(e<=0)){var h,k=i[m];for(util.$e(k);e--;)h=k.pop(),room.setPlayerTeam(h.id,h.team=0)}}},Me:i=>{var n=_modules.ue;if(n.Z&&!n.de){const o=i.red>i.blue?1:2,u=3-o;let e=!n.pe,a;a=1==o?`🏆 Kırmızı ${i.red} - ${i.blue} kazandı!`:`🏆 Mavi ${i.blue} - ${i.red} kazandı!`,n.pe&&(n.fe[u-1]=0,i=++n.fe[o-1],a+=" Galibiyet serisi: "+i,n._e)&&i>=n._e&&(e=!0,n.fe=[0,0],a+=". Uzun seri, takımlar karılıyor.."),room.sendAnnouncement(a,null,1==o?15035990:5671397);const m=n.me,d=[[],[],[]];playerDB.G.forEach(e=>{var a=e.team;a<3&&d[a].push(e)});var i=d[o],s=d[u];const c=playerDB.Le;let l=room.getPlayerList().map(e=>c[e.id]).filter(e=>0===e.team),t=(s.forEach(e=>{room.setPlayerTeam(e.id,e.team=0)}),util.$e(s),l=l.concat(s),Math.min(l.length,m[0]+m[1]-i.length)),r;if(e){util.$e(i);s=Math.floor(m[u-1]/2);i.slice(0,s).forEach(e=>{room.setPlayerTeam(e.id,e.team=u)});let e=i.length-2*s,a=u;for(;t--;)r=l.splice(0,1),room.setPlayerTeam(r.id,r.team=a),--e<1&&(a=3-a)}else for(;t--;)r=l.splice(0,1),room.setPlayerTeam(r.id,r.team=u);n.be()}},g:{balance:{f:(e,a,l,t,r,i,n=5)=>{var s=_modules.ue;let o=!0;switch(a){case"info":o=!1;break;case"once":return s.be(),util.say(e.name+" takımları dengeledi");case"auto":case"manual":s.de="manual"===a,util.U(e.name+" set balancing to "+(s.de?"manual":"automatic"),2);break;case"mode":if(void 0===l||void 0===t)return util.$(e,"balance");var u=s.me,m=[u[0],u[1]];u[0]=l,u[1]=t,m[0]<=l&&m[1]<=t||playerDB.G.forEach(e=>{e.team<3&&room.setPlayerTeam(e.id,e.team=0)}),s.be(),s.pe=!!r,s.ce=i=(i=void 0===i?l<4:i)&&l!==t?!1:i,s._e=n}var d=s._e?` (max. ${s._e} maç seri)`:"",d=`Denge modu: ${s.me[0]}v${s.me[1]} (Eşit takımlar: ${s.ce?"✔️":"❌"}) (Yenen sahada: ${s.pe?"✔️"+d:"❌"})`;o?util.U(d+` (${e.name})`,2):util.D(e,d)},B:2,cd:3,A:!1,N:{O:1,T:[{j:"string",S:["mode","info","auto","manual","once"]},{j:"number",R:0},{j:"number",R:0},{j:"boolean"},{j:"boolean"},{j:"number",R:0}]},C:[".bal info: shows current balancing mode",".bal once: balances the teams (not needed in auto mode)",".bal mode [nRed] [nBlue] [winnerStays] [forceEqualTeams] [maxStreak]: sets team balancing mode"],F:["bal"]},afk:{f:(e,a)=>{if(void 0===a)a=e;else if(e.M<1)return util._(e,{j:"noAllow"});var l=3!==a.team;room.setPlayerTeam(a.id,0),a.team=l?3:0,util.say(a.name+` ${l?"AFK":"oyuna geri döndü"}.`+(a.id!==e.id?` (${e.name})`:"")),_modules.ue.be(),l&&a.id!==e.id&&room.sendAnnouncement("⚠️ "+a.name+", AFK olduğunuz tespit edildi. Lütfen oyuna geri dönmek için .afk komutunu kullanın.",a.id,10151397,"bold",2)},B:0,cd:30,A:!1,N:{O:0,T:[{j:"player"}]},C:[".afk: toggles your AFK status",".afk [player]: toggles another player's AFK status"]},mix:{f:e=>{playerDB.G.forEach(e=>{e.team<3&&room.setPlayerTeam(e.id,e.team=0)}),_modules.ue.be(),util.say(e.name+" takımları kardı")},B:1,cd:3,A:!1,N:{O:0,T:[]},C:[".mix: shuffles the teams"]},remix:{f:e=>{room.stopGame(),playerDB.G.forEach(e=>{e.team<3&&room.setPlayerTeam(e.id,e.team=0)}),_modules.ue.be(),util.say(e.name+" takımları kardı"),room.startGame()},B:1,cd:3,A:!1,N:{O:0,T:[]},C:[".remix: shuffles the teams and restarts the game"]},red:{f:(e,a)=>{a.m.forEach(e=>{room.setPlayerTeam(e.id,e.team=1)}),util.say(`${a.X} kırmızı takıma geçti (${e.name})`)},B:1,cd:5,A:!1,N:{O:1,T:[{j:"players"}]},C:[".red [players]: moves player(s) to red team"]},blue:{f:(e,a)=>{a.m.forEach(e=>{room.setPlayerTeam(e.id,e.team=2)}),util.say(`${a.X} mavi takıma geçti (${e.name})`)},B:1,cd:5,A:!1,N:{O:1,T:[{j:"players"}]},C:[".blue [players]: moves player(s) to blue team"]},spec:{f:(e,a)=>{a.m.forEach(e=>{room.setPlayerTeam(e.id,e.team=0)}),util.say(`${a.X} izleyicilere geçti (${e.name})`)},B:1,cd:5,A:!1,N:{O:1,T:[{j:"players"}]},C:[".spec [players]: moves player(s) to spectators"]},swap:{f:(e,a,l)=>{a.team*l.team==2?(room.setPlayerTeam(a.id,a.team=3-a.team),room.setPlayerTeam(l.id,l.team=3-l.team),util.say(`${a.name} ile ${l.name} takas edildi (${e.name})`)):util._(e,"Bu iki oyuncuyu takas edemezsiniz")},B:1,cd:5,A:!1,N:{O:2,T:[{j:"player"},{j:"player"}]},C:[".swap [player1] [player2]: swaps players between two teams"]}}},we:{t:"⚖️ Ekstra",Z:!1,p:(e,a)=>{var l=_modules.we,a=(l.Z=a,l.Be);return a.De=a.ze[0],l.ke(),!0},ke:()=>{var e=_modules.we;e.Z&&e.Ae?(room.onPlayerBallKick=e=>{var a=playerDB;a.Ne=a.xe,a.xe=e},room.onTeamGoal=e=>{var a=playerDB,l=room.sendAnnouncement,t=1===e?15035990:5671397,r=room.getScores();let i=a.xe,n=a.Ne;i=(i=i&&a.Le[i.id])||{id:0,name:"?",team:e},n=(n=n&&a.Le[n.id])||{id:0,name:"?",team:e};let s,o=(s=i.team===e?"⚽ Gol: "+i.name+(n.team!==e||i.id===n.id?"":" 🎯 Asist: "+n.name):"⚽ Gol (KK): "+i.name,Math.floor(r.time/60)),u=(o<10&&(o="0"+o),Math.floor(r.time-60*o)),m;switch(u%10){case 0:case 6:case 9:m="da";break;case 1:case 2:case 7:case 8:m="de";break;case 3:case 4:case 5:m="te"}u<10&&(u="0"+u),l(s+=`. ${1===e?"Kırmızı":"Mavi"} takım ${o}:${u}'${m} skoru ${r.red} - ${r.blue} yaptı.`,null,t)}):(room.onPlayerBallKick=null,room.onTeamGoal=null)},Be:{De:null,ze:[{Oe:"default",Te:[[1,60,16777215,[15035990,15035990,15035990]],[2,60,16777215,[5671397,5671397,5671397]]]},{Oe:"trippy",Te:[[1,60,16777215,[13098580,14588244,14570603]],[2,60,16777215,[13063390,7034078,5544414]]]},{Oe:"purple & teal",Te:[[1,60,16777215,[16187581,11468994,7012531]],[2,60,16777215,[3665292,3525836,3834818]]]},{Oe:"black & white",Te:[[1,60,4473924,[15921906,13421772,10921638]],[2,60,16777215,[5855577,3355443,855309]]]},{Oe:"dark",Te:[[1,60,16777215,[15036247,13581856,9251350]],[2,60,16777215,[5736933,2121423,1458317]]]},{Oe:"light",Te:[[1,60,16777215,[15371643,15036247,14635316]],[2,60,16777215,[8102634,5736933,3436767]]]},{Oe:"red & blue",Te:[[1,60,16777215,[16748922,9720903,5188902]],[2,60,16777215,[8038911,4678292,2503759]]]}]},Ae:!0,g:{kits:{f:(t,r)=>{const i=_modules.we.Be,n=i.ze,s=util.D;switch(r){case"list":n.forEach((e,a)=>{s(t,`[${a}]: `+e.Oe)});break;case"print":var o=i.De;s(t,`Current kits: '${o.Oe}'`),o.Te.forEach(e=>s(t,`/colors ${1===e[0]?"red":"blue"} ${e[1]} ${e[2].toString(16)} `+e[3].map(e=>e.toString(16)).join(" "))),o.Te.forEach(e=>s(t,`room.setTeamColors(${e[0]},${e[1]},0x${e[2].toString(16)},[${e[3].map(e=>"0x"+e.toString(16)).join(",")}]);`));break;default:let e=-1,a=null,l=!1;"random"===r?(l=!0,a=n[~~(Math.random()*n.length)]):r.length<2&&(e=parseInt(r)),a||-1!==(e=isNaN(e)||e<0||e>=n.length?n.findIndex(e=>e.Oe.includes(r)):e)&&(a=n[e]),a?(room.setTeamColors(...a.Te[0]),room.setTeamColors(...a.Te[1]),i.De=a,util.U(t.name+" set kits: "+a.Oe+(l?" (random)":""),1)):util._(t,"Forma bulunamadı")}},B:1,cd:3,A:!1,N:{O:1,T:[]},C:[".kits ( [id] / [name] / random ): sets team kits",".kits [list]: shows available kits",".kits [print]: prints the current kits"]},kicktracking:{f:(e,a)=>{var l=_modules.we;l.Ae=a,l.ke(),util.U(e.name+" set goal & assist tracking "+(a?"on":"off"),3)},B:3,cd:3,A:!1,N:{O:1,T:[{j:"boolean"}]},C:[".kicktracking [boolean]: sets goal and assist tracking on / off"]}}}}),playerDB={G:[],Le:{},xe:null,Ne:null},aliasDB={H:{base:_modules.l,security:_modules.J,teams:_modules.ue,extras:_modules.we},P:{},K:{}},util={$e:e=>{let a=Math,l;var t=a.floor,r=a.random;for(a=e.length-1;0<a;a--)l=t(r()*(a+1)),[e[a],e[l]]=[e[l],e[a]]},je:(e,a,l)=>{var t=aliasDB.H[a];if(!t)return util._(e,"Module name must be one of: "+Object.keys(aliasDB.H).join(","));var r=l?"on":"off";if(l===t.Z)return util.D(e,a+" module is already "+r);if(!t.p(e,l))return util._(e,"Cannot turn this module "+r);t.Z=l;t=t.g;if(l){for(var[i,n]of Object.entries(t))if((aliasDB.K[i]=n).F)for(const u of n.F)aliasDB.P[u]=n}else for(var[s,o]of Object.entries(t))if(delete aliasDB.K[s],o.F)for(const m of o.F)delete aliasDB.P[m];util.U(e.name+` turned ${a} module `+r,4)},Ce:(a,e)=>{var l=Date.now(),t=a.Fe,r=util,i=e.substring(1).split(" "),n=i[0].toLowerCase(),e=aliasDB.K[n]||aliasDB.P[n];if(a.M<4){if(t.Ke>=l)return r._(a,"Lütfen komutları tekrar kullanmak için biraz bekleyin");t.Ke=l+3e3}if(!e)return r._(a,"Komut bulunamadı: "+n);if(e.B>a.M)return r._(a,{j:"noAllow"});var s=e.N.T,o=i.length-1,u=e.N.O;if(o<u)return r._(a,`En az ${u} argüman gerekli`),r.$(a,n);let m,d,c,p,_=[];for(m=0;m<o;m++){switch(d=s[m]||{},c=i[m+1],d.j){case"string":if(p=c,d.S&&!d.S.includes(p))return r._(a,m+1+". argüman için geçerli değerler: "+d.S.join(", ")),r.$(a,n);break;case"player":if(!(p=r.oe(c)))return r._(a,"Oyuncu bulunamadı: "+c),r.$(a,n);if(d.ie&&p.M>=a.M)return r._(a,p.name+` üzerinde .${n} yetkiniz yok`);break;case"players":if(1===(p=r.Pe(c)).length&&!p[0])return r._(a,"Oyuncu bulunamadı: "+c),r.$(a,n);d.ie&&(p.m=p.m.filter(e=>e.M<a.M));break;case"number":if(p=util.Y(c,d.R,d.q),isNaN(p))return r._(a,m+1+`. argüman (${c}) bir sayı olmalı`),r.$(a,n);break;case"boolean":p=util.V(c);break;case"object":try{"{"===c[0]?"}"===c.slice(-1)&&(p=JSON.parse(c)):p=JSON.parse("{"+c+"}")}catch(e){return r._(a,m+1+". argüman 'key1:value1,key2:value2' şeklinde bir obje olmalı"),r._(a,e),r.$(a,n)}break;default:p=c}_.push(p)}return a.M<4&&(t.Ke=l+1e3*e.cd),e.f(a,..._)},ne:(e,a,l,t)=>{e.M=a,room.setPlayerAdmin(e.id,0<a&&!!l),2<a&&Object.assign(e.Fe,{Se:0,Ke:0}),util.U(`${e.name} admin level ${a} (${l?"visible":"hidden"}) (${t?t.name:"bot"})`,a)},W:(e=0)=>{var a;room.stopGame(),0<e&&(a=_modules.l.h,clearTimeout(a.v),clearTimeout(a.k),util.say(`Oyun ${e} saniye sonra tekrar başlayacak`),a.v=setTimeout(room.startGame,1e3*e))},$:(a,e)=>{const l=aliasDB.K[e]||aliasDB.P[e],t=util.D;if(!l)return util._(a,"Komut bulunamadı: "+e);if(l.B>a.M)return util._(a,{j:"noAllow"});t(a,`.${e} komutunun kullanımı:`);e=l.C;e&&e.length&&e.forEach(e=>t(a,e))},say:e=>{room.sendAnnouncement(e+"",null,9633550)},D:(e,a,l)=>{room.sendAnnouncement("💬 "+(l?"(PM from "+l.name+") ":"")+a,e.id,10151397),l&&room.sendAnnouncement("💬 (PM to "+e.name+") "+a,l.id,10151397)},_:(e,a)=>{"object"==typeof a&&(a="noAllow"===a.j?"Bu eylem için yetkiniz yok":"Bir hata oldu"),room.sendAnnouncement("❌ "+a,e.id,16473951)},U:(a,l=1)=>{a="(⭐"+l+") "+a;const t=room.sendAnnouncement;playerDB.G.filter(e=>e.M>=l).forEach(e=>{t(a,e.id,16768768)})},re:(e,a,l,t=null,r=!0)=>{e.Fe.Se=0<l?a+6e4*l:0,r&&util.say(`🔕 ${e.name} `+(0<l?l+" dakika susturuldu":"artık konuşabilir")+(t?` (${t})`:""))},V:e=>{if("string"==typeof e)switch(e){case"on":case"1":case"y":case"yes":case"true":return!0;default:return!1}return!1},Y:(e,a,l)=>{let t=parseFloat(e);return isNaN(t)||(void 0!==a&&t<a?t=a:void 0!==l&&t>l&&(t=l)),t},oe:(e=null,a)=>{if(null===e||e.length<1)return null;if("#"===e[0])return playerDB.Le[parseInt(e.substring(1))];"@"===e[0]&&(e=e.substring(1)),a=a||playerDB.G,e=e.toLocaleLowerCase();let l,t,r,i=null;for(l=a.length-1;0<=l;l--){if(t=a[l],(r=t.name.toLocaleLowerCase())===e)return t;r.includes(e)&&(i=t)}return i},Pe:e=>{var a={m:null,X:"(?)"};switch(e){case"r":case"red":a.m=playerDB.G.filter(e=>1===e.team),a.X="kırmızı takım";break;case"b":case"blue":a.m=playerDB.G.filter(e=>2===e.team),a.X="mavi takım";break;case"s":case"spec":a.m=playerDB.G.filter(e=>0===e.team),a.X=a.m.length+" izleyici";break;case"afk":a.m=playerDB.G.filter(e=>3===e.team),a.X=a.m.length+" AFK oyuncu";break;case"all":a.m=playerDB.G.slice(),a.X="herkes";break;default:var l=util.oe(e);a.m=[l],l&&(a.X=l.name)}return a}};room.onTeamVictory=e=>{room.stopGame();var a=_modules.l.h;clearTimeout(a.v),clearTimeout(a.k),_modules.ue.Me(e);util.say("Yeni oyun 10 saniye sonra başlayacak"),a.v=setTimeout(room.startGame,1e4)},room.onGamePause=e=>{let a=!0;e&&(e=playerDB.Le[e.id]).M<2&&(util.say(e.name+", oyunu duraklatma yetkiniz yok. Adminliğiniz alındı"),room.setPlayerAdmin(e.id,!1),e.M=0,room.pauseGame(!1),a=!1),a&&(util.say("Oyun 30 saniye sonra devam edecek"),_modules.l.h.k=setTimeout(()=>{room.pauseGame(!1)},3e4))},room.onGameUnpause=e=>{clearTimeout(_modules.l.h.k)},room.onGameStart=e=>{clearTimeout(_modules.l.h.v),clearTimeout(_modules.l.h.k),_modules.we.Ae&&(playerDB.xe=null,playerDB.Ne=null)},room.onGameStop=e=>{e&&util.W(30)},room.onPositionsReset=()=>{_modules.we.Ae&&(playerDB.xe=null,playerDB.Ne=null)},room.onPlayerKicked=(e,a,l,t)=>{t=t||{id:0,name:"bot"},l&&((r=_modules.J.ae).push({id:e.id,name:e.name,reason:a,Re:t.id,Ee:t.name}),30<r.length)&&r.splice(0,1);var r,a=playerDB.Le[t.id];a&&a.M<2&&(l&&(room.clearBan(e.id),util.say(e.name+" ban kaldırıldı")),room.kickPlayer(a.id,"Oyuncu kickleme yetkiniz yok",!1))},room.onPlayerAdminChange=(e,a)=>{if(a){var l=playerDB.Le[e.id],t=playerDB.Le[a.id];if(!e.admin&&l.M>t.M)return util.U(a.name+" is not authorized to demote "+e.name,t.M),room.setPlayerAdmin(e.id,!0);l.M=e.admin?Math.max(1,l.M):0,util.U(`${e.name} ${l.M<1?"adminliği alındı":"admin level "+l.M} (${a.name})`,t.M)}},room.onPlayerJoin=e=>{const t=e.id,r=e.name,i=e.auth,n=e.conn;var s=_modules.J;{if("@"===r[0]||"#"===r[0])return room.kickPlayer(t,"Adınızın başında @ ya da # karakteri bulunamaz",!1);var o,u=r.toLocaleLowerCase();let a,l=playerDB.G;for(a of l)if(a.name.toLocaleLowerCase()===u)return room.kickPlayer(t,"Odada aynı adlı bir oyuncu var.",!1);if(s.Z){let e=!1;if(s.te)for(a of l)if(a.auth===i||a.conn===n)return room.kickPlayer(t,"Çoklu giriş ("+a.name+")",!1);for(a of s.bl_rules){switch(o=a._rdata,a._rtype){case"exactname":r===o&&(e=!0);break;case"namepart":u.includes(o)&&(e=!0);break;case"auth":i===o&&(e=!0);break;case"conn":n===o&&(e=!0)}if(e)break}if(e)return room.kickPlayer(t,"blacklist",!0)}}var a,l=Date.now(),l={id:e.id,name:e.name,team:0,M:0,Fe:{Se:-(l+1e4),qe:0,Ge:0,Ke:l+5e3},auth:e.auth,conn:e.conn},m=playerDB,m=(m.G.push(m.Le[e.id]=l),_modules.J.ee),e=m.findIndex(e=>e.auth===i||e.conn===n),d=(-1!==e?(0<(d=(a=m[e]).Fe).Se&&(l.Fe.Se=d.Se),d.Ke>l.Fe.Ke&&(l.Fe.Ke=d.Ke),a.name!==r&&util.U(r+" önceki adı: "+a.name,1),Object.assign(a,{id:t,name:r,auth:i,conn:n}),m.push(m.splice(e,1)[0])):(m.push({id:t,name:r,auth:i,conn:n,Fe:structuredClone(l.Fe)}),30<m.length&&m.splice(0,1)),s.I.m.find(e=>e.a===i));d&&util.ne(l,d.L,!1,{name:"trusted"}),_modules.ue.be()},room.onPlayerLeave=e=>{const a=playerDB,l=e.id,t=a.Le[l];var r;t&&(delete a.Le[l],a.G=a.G.filter(e=>e.id!==l),-1!==(r=(e=_modules.J.ee).findIndex(e=>e.id===l))?(e[r].Fe=structuredClone(t.Fe),e.push(e.splice(r,1)[0])):(e.push({id:l,name:t.name,auth:t.auth,conn:t.conn,Fe:structuredClone(t.Fe)}),30<e.length&&e.splice(0,1)),_modules.ue.be())},room.onPlayerTeamChange=(e,a)=>{if(a){var l=playerDB.Le[e.id];if(l)return 3===l.team&&0<e.team?(room.setPlayerTeam(e.id,0),util._(a,e.name+" AFK!")):void(l.team=e.team)}},room.onPlayerChat=(l,t)=>{var r=(l=playerDB.Le[l.id]).Fe,i=Date.now();if(l.M<2){let e,a=r.Se;if(a<0&&(-a<i?r.Se=0:15<t.length&&(a=r.Se=-a)),a>i)return util._(l,"Şu anda yazı yazamazsınız"),!1;if(5e3<(e=i-r.qe))r.Ge=0;else if(e<1100&&1<++r.Ge)return r.Ge=0,util.re(l,i,1,"spam"),!1;r.qe=i}var e=t[0];if(!("."!==e&&"!"!==e||"."===(e=t[1])||2===t.length&&"d"===e))try{return util.U(l.name+": "+t,5),r.Ke>=i?(util._(l,"Lütfen komutları tekrar kullanmak için biraz bekleyin"),!1):!!util.Ce(l,t)&&void 0}catch(e){return util.U(l.name+", ["+e.name+"] "+e.message+" @"+e.lineNumber+": "+t,l.M),!1}},(e=>{var a={name:"bod",id:0};let l=util.je;l(a,"base",!0),l(a,"security",!0),l(a,"teams",!0),l(a,"extras",!0),(l=aliasDB.K.fetch.f)(a,"admins",e.adminsURL),l(a,"maps",e.mapsURL),_modules.J.se=e.adminPasswords,"pw_"===e.adminPasswords[0][0].substring(0,3)&&console.log("Make sure to change default admin passwords at the end of the code. They are publicly visible on github!")})({mapsURL:"https://raw.githubusercontent.com/uzayyli/Haxball-Headless-Bot/main/v7/v7_example_maps.json",adminsURL:"https://raw.githubusercontent.com/uzayyli/Haxball-Headless-Bot/main/v7/v7_example_admins.json",adminPasswords:[["pw_L1","pw_L1_another"],["pw_L2"],["pw_L3"],["pw_LL4"]]})})();